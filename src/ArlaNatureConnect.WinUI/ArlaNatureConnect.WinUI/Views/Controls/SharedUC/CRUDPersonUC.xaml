<?xml version="1.0" encoding="utf-8"?>
<UserControl
  x:Class="ArlaNatureConnect.WinUI.Views.Controls.SharedUC.CRUDPersonUC"
  x:Name="Root"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:local="using:ArlaNatureConnect.WinUI.Views.Controls.SharedUC"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
  xmlns:shareduc="using:ArlaNatureConnect.WinUI.ViewModels.Controls.SharedUC" 
  xmlns:conv="using:ArlaNatureConnect.WinUI.Converters"
  d:DataContext="{d:DesignInstance Type=shareduc:CRUDPersonUCViewModel}"
  mc:Ignorable="d">
  <UserControl.Resources>
    <conv:AlternationToBrushConverter x:Key="AlternationToBrushConverter" />
  </UserControl.Resources>

  <Grid Padding="8">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="Auto"/> <!-- Header row (fixed) -->
      <RowDefinition Height="*"/> <!-- ListView row fills remaining space -->
    </Grid.RowDefinitions>

    <StackPanel Orientation="Vertical" Grid.Row="0" Spacing="8">
      <StackPanel Orientation="Horizontal" Spacing="8">
        <TextBlock Text="{Binding LabelFirstName, Mode=OneTime}" VerticalAlignment="Center" Width="120" />
        <TextBox Text="{Binding FirstName, Mode=TwoWay}" Width="300" />
      </StackPanel>

      <StackPanel Orientation="Horizontal" Spacing="8">
        <TextBlock Text="{Binding LabelLastName, Mode=OneTime}" VerticalAlignment="Center" Width="120" />
        <TextBox Text="{Binding LastName, Mode=TwoWay}" Width="300" />
      </StackPanel>

      <StackPanel Orientation="Horizontal" Spacing="8">
        <TextBlock Text="{Binding LabelEmail, Mode=OneTime}" VerticalAlignment="Center" Width="120" />
        <TextBox Text="{Binding Email, Mode=TwoWay}" Width="300" />
      </StackPanel>

      <StackPanel Orientation="Horizontal" Spacing="8">
        <TextBlock Text="{Binding LabelIsActive, Mode=OneTime}" VerticalAlignment="Center" Width="120" />
        <ToggleSwitch IsOn="{Binding IsActive, Mode=TwoWay}" />
      </StackPanel>

      <!-- RoleId and AddressId are simple text fields here. Replace with ComboBox when collections are available. -->
      <StackPanel Orientation="Horizontal" Spacing="8">
        <TextBlock Text="{Binding LabelRoleId, Mode=OneTime}" VerticalAlignment="Center" Width="120" />
        <TextBox Text="{Binding RoleId, Mode=TwoWay}" Width="300" />
      </StackPanel>

      <StackPanel Orientation="Horizontal" Spacing="8">
        <TextBlock Text="{Binding LabelAddressId, Mode=OneTime}" VerticalAlignment="Center" Width="120" />
        <TextBox Text="{Binding AddressId, Mode=TwoWay}" Width="300" />
      </StackPanel>
    </StackPanel>


    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Spacing="8" Margin="0,12,0,0" Grid.Row="5">
      <Button Content="Add" Command="{Binding AddCommand}" />
      <Button Content="Save" Command="{Binding SaveCommand}" />
      <Button Content="Delete" Command="{Binding DeleteCommand}" />
      <Button Content="Cancel" Command="{Binding CancelCommand}" />
      <Button Content="Refresh" Command="{Binding RefreshCommand}" />
    </StackPanel>

    <!-- Fixed header row placed outside the ListView so it remains visible while scrolling -->
    <StackPanel Orientation="Horizontal" Grid.Row="6" Spacing="8" Margin="0,12,0,0">
      <Button Content="{Binding LabelFirstName, Mode=OneTime}"
              Width="100"
              FontWeight="SemiBold"
              Command="{Binding SortCommand}"
              CommandParameter="FirstName"
              Background="Transparent"
              BorderThickness="0" />
      <Button Content="{Binding LabelLastName, Mode=OneTime}"
              Width="100"
              FontWeight="SemiBold"
              Command="{Binding SortCommand}"
              CommandParameter="LastName"
              Background="Transparent"
              BorderThickness="0" />
      <Button Content="{Binding LabelEmail, Mode=OneTime}"
              Width="200"
              FontWeight="SemiBold"
              Command="{Binding SortCommand}"
              CommandParameter="Email"
              Background="Transparent"
              BorderThickness="0" />
      <Button Content="{Binding LabelIsActive, Mode=OneTime}"
              Width="50"
              FontWeight="SemiBold"
              Command="{Binding SortCommand}"
              CommandParameter="IsActive"
              Background="Transparent"
              BorderThickness="0" />
      <Button Content="{Binding LabelRoleId, Mode=OneTime}"
              Width="50"
              FontWeight="SemiBold"
              Command="{Binding SortCommand}"
              CommandParameter="RoleId"
              Background="Transparent"
              BorderThickness="0" />
      <Button Content="{Binding LabelAddressId, Mode=OneTime}"
              Width="50"
              FontWeight="SemiBold"
              Command="{Binding SortCommand}"
              CommandParameter="AddressId"
              Background="Transparent"
              BorderThickness="0" />
    </StackPanel>

    <ListView Grid.Row="7"
              ItemsSource="{Binding Items, Mode=OneWay}"
              SelectedItem="{Binding SelectedItem}"
              Margin="0,8,0,0"
              MaxHeight="300">

       <ListView.ItemContainerStyle>
        <Style TargetType="ListViewItem">
        </Style>
       </ListView.ItemContainerStyle>

       <ListView.ItemTemplate>
        <DataTemplate>
          <StackPanel Orientation="Horizontal" Spacing="8" Background="{Binding DataContext.ItemCounter, ElementName=Root, Converter={StaticResource AlternationToBrushConverter}}">
            <TextBlock Text="{Binding FirstName}" Width="100" />
            <TextBlock Text="{Binding LastName}" Width="100" />
            <TextBlock Text="{Binding Email}" Width="200" />
            <TextBlock Text="{Binding IsActive}" Width="50" />
            <TextBlock Text="{Binding RoleId}" Width="50" />
            <TextBlock Text="{Binding AddressId}" Width="50" />
          </StackPanel>
        </DataTemplate>
      </ListView.ItemTemplate>
    </ListView>
  </Grid>
</UserControl>
