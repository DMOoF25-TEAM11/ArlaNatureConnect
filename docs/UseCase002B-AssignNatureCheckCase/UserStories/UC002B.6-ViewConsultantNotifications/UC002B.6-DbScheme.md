## Relational Database Schema â€“ UC002B.6: View Consultant Notifications

### **Entity Framework Core Implementation**

**Note:** In Entity Framework Core implementation, stored procedures are replaced by:

- **LINQ queries** in repositories (e.g., `INatureCheckCaseRepository.GetAssignedCasesForConsultantAsync()`)
- **DTOs** created in service layer (e.g., `ConsultantNotificationDto`)
- **In-memory processing** for aggregations and transformations

**Repository Methods Used:**
- `INatureCheckCaseRepository.GetAssignedCasesForConsultantAsync()` - Retrieves assigned cases for consultant
- `IFarmRepository.GetAllAsync()` - Loads farm information for notifications

**Service Methods:**
- `NatureCheckCaseService.GetNotificationsForConsultantAsync()` - Orchestrates notification generation
  - Queries NatureCheckCases for consultant
  - Loads related Farm entities
  - Converts to ConsultantNotificationDto objects
  - Returns DTOs sorted by AssignedAt date (newest first)

**Important:** Notifications are **NOT stored in database**. They are generated from `NatureCheckCase` entities:
- No `Notifications` table exists
- Notifications are created as `ConsultantNotificationDto` objects from case data
- No "mark as read" functionality - notifications are always current based on case data

**No stored procedures needed** - all data access through EF Core repositories.

---

### **Business Rules**

1. Cases are sorted by AssignedAt date (newest first) - done in service layer
2. Notifications are generated from NatureCheckCase data, not stored separately
3. All operations use Entity Framework Core repositories with LINQ queries


