## Relational Database Schema â€“ UC002B.5: Delete Farm

### **Entity Framework Core Implementation**

**Note:** In Entity Framework Core implementation, stored procedures are replaced by:

- **LINQ queries** in repositories (e.g., `INatureCheckCaseRepository.FarmHasActiveCaseAsync()`)
- **EF Core Delete operations** with cascade delete configuration
- **In-memory processing** for validations

**Repository Methods Used:**
- `INatureCheckCaseRepository.FarmHasActiveCaseAsync()` - Checks for active cases
- `IFarmRepository.DeleteAsync()` - Deletes farm (cascade delete configured in EF)

**Service Methods:**
- `NatureCheckCaseService.DeleteFarmAsync()` - Orchestrates farm deletion
  - Validates no active cases exist
  - Prevents deletion if active cases exist
  - Deletes farm if no active cases
  - EF Core cascade delete handles related data (addresses, cases)

**No stored procedures needed** - all data access through EF Core repositories.

---

### **Business Rules**

1. Farms with active cases cannot be deleted (validated via `INatureCheckCaseRepository.FarmHasActiveCaseAsync()`)
2. Deletion cascades to related data (addresses, cases) - configured in EF Core entity relationships
3. All operations use Entity Framework Core repositories


