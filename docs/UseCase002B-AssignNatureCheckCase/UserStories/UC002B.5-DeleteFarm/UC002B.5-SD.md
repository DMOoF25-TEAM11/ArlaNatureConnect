## UC002B.5 – Sequence Diagram: Delete Farm

This sequence diagram shows the detailed interaction flow when an Arla employee deletes a farm, following Larmann's UML conventions.

**Notes:**
- All method calls use PascalCase (C# convention).
- All calls have return arrows (including void methods).
- Exception handling follows UML conventions with alt fragments for alternatives.
- Activation bars show object lifetime using automatic activation/deactivation (+/-).

```mermaid
sequenceDiagram
    title UC002B.5 – Sequence Diagram: Delete Farm

    actor ArlaEmployee as Arla Employee
    participant ViewModel as ArlaEmployeeAssignNatureCheckViewModel
    participant Service as NatureCheckCaseService
    participant FarmRepo as IFarmRepository
    participant CaseRepo as INatureCheckCaseRepository
    participant MsgService as IAppMessageService

    ArlaEmployee ->>+ ViewModel: DeleteFarmAsync(farmId)
    ViewModel ->>+ Service: DeleteFarmAsync(farmId)
    
    Service ->>+ CaseRepo: FarmHasActiveCaseAsync(farmId)
    CaseRepo -->>- Service: bool
    
    alt Has active case
        Service -->> ViewModel: InvalidOperationException
        ViewModel ->>+ MsgService: AddErrorMessage("Gården har aktive opgaver")
        MsgService -->>- ViewModel: void
        ViewModel -->> ArlaEmployee: void
    else No active case
        Service ->>+ FarmRepo: DeleteAsync(farmId)
        FarmRepo -->>- Service: void
        Service -->> ViewModel: void
        ViewModel ->>+ ViewModel: RefreshFarmList()
        ViewModel -->>- ViewModel: void
        ViewModel -->> ArlaEmployee: void
    end
    
    deactivate ViewModel
```
