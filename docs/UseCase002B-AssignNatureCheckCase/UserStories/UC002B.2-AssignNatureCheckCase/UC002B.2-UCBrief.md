# Brief Use Case – UC002B.2: Assign Nature Check Case to Consultant

**Use Case ID:** UC002B.2  
**Use Case Name:** Assign Nature Check Case to Consultant  
**Scope:** System prototype (Arla Nature Connect)  
**Level:** User goal  
**Primary Actor:** Arla Employee (Admin / Sustainability Staff)

---

## Brief Description

The Arla employee creates a new Nature Check Case for a selected farm and assigns it to a consultant with optional priority level and notes. Notifications are generated from the case data when the consultant views them (not stored in database).

---

## Preconditions

1. The Arla employee is authenticated in the system (UC01).
2. The selected farm exists in the system.
3. The selected person exists in the system and has the Consultant role.
4. No active Nature Check Case is currently assigned to the same farm (unless duplicate assignment is explicitly allowed).
5. If a priority is selected, it is a valid priority level.

---

## Postconditions

1. A new Nature Check Case is created in the system with the following properties:
   - The case is linked to the selected farm
   - The case is assigned to the selected consultant
   - The case is marked as assigned by the authenticated Arla employee
   - The case status is set to "Assigned"
   - If provided, notes are stored with the case
   - If provided, priority level is stored with the case (English format)
   - The case creation time is recorded
   - The case assignment time is recorded
2. The farm's assignment status is updated to show it has an active case.
3. Notifications are available when consultant views them (generated from case data, not stored in database).
4. The Arla employee sees a success confirmation message: "Natur Check opgave er oprettet for [FarmName]."

---

## Main Success Scenario

1. The Arla employee has viewed farms and consultants (UC002B.1).
2. The employee selects a farm that does not have an active case.
3. The employee selects a consultant from the consultant list.
4. The employee optionally selects a priority level (Lav, Normal, Høj, Haster).
5. The employee optionally enters notes about the assignment.
6. The employee clicks "Lav natur Check opgave" (Create Nature Check task).
7. The system validates the farm, consultant role, priority format, and business rules.
8. The system creates a new Nature Check Case with status "Assigned".
9. The system stores priority in English format ("Low", "Medium", "High", "Urgent").
10. The system updates the farm list to show "Tilføjet" status.
11. Notifications are generated from case data when consultant views them (not stored in database).
12. The system displays success message: "Natur Check opgave er oprettet for [FarmName]."

---

## Extensions

### 2a. Farm does not exist:
The system displays an error and directs the employee to create the farm first (UC002B.4).

### 3a. No consultant selected:
The system prompts the employee to choose a consultant before continuing.

### 3b. Selected user is not a consultant:
The system rejects the selection and asks for a valid consultant.

### 3c. Consultant does not exist or is inactive:
The system prevents assignment and requests another consultant.

### 4a. No priority selected:
Priority is optional - the system allows assignment without priority.

### 4b. Priority value is invalid:
The system validates priority format (must be "Low", "Medium", "High", or "Urgent" in English) and rejects invalid values.

### 7a. Farm already has an active case:
The system displays error: "Gården har allerede en aktiv Natur Check opgave."  
The employee can either:
- Cancel the operation, or
- Select a different farm, or
- Update the existing case (UC002B.3)

### 10a. No cases found for consultant:
The consultant will see an empty notification list when viewing notifications (UC002B.6).

---

## Technology Notes

- Priority values: UI displays Danish ("Lav", "Normal", "Høj", "Haster"), database stores English ("Low", "Medium", "High", "Urgent").
- Notifications: Generated from NatureCheckCase data when consultant views them (not stored in database). ConsultantNotificationDto objects are created in-memory from case data.
- The system uses Entity Framework Core repositories for all database operations (not stored procedures).


