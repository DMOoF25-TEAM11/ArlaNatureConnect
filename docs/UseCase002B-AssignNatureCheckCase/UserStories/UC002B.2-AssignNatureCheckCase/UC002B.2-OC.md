# Operation Contracts – UC002B.2: Assign Nature Check Case to Consultant

---

## **Operation Contract – UC002B.2: Assign Nature Check Case**

| Item | Description |
|------|-------------|
| **Operation** | Create a new Nature Check Case for the selected farm and assign it to the selected consultant. This is the main operation that orchestrates validation, case creation, and notification. |
| **Cross References** | UC002B.2 – Assign Nature Check Case to Consultant<br/>UC002B-SSD: Steps 8-9<br/>UC002B-SD: Steps 41-59<br/><br/>**Uses:** Validate Consultant Role, Check Farm Has Active Case, Convert Priority to English, Create Notification |
| **Preconditions** | • The selected farm exists in the system.<br>• The selected person exists in the system and has the Consultant role.<br>• The Arla employee assigning the case is authenticated.<br>• No active Nature Check Case is currently assigned to the same farm. |
| **Postconditions** | • A new Nature Check Case is created and linked to the farm and consultant.<br>• Case status is set to "Assigned".<br>• Case creation and assignment timestamps are recorded.<br>• Notifications are available when consultant views them (generated from case data, not stored in database).<br>• Arla employee sees success confirmation message. |
| **Input** | • Farm ID<br>• Consultant ID<br>• Assigned By Person ID<br>• Priority (optional, Danish format from UI)<br>• Notes (optional) |
| **Output** | • Created Nature Check Case entity<br>• Success confirmation message |
| **Exceptions** | • `InvalidOperationException` if farm already has active case<br>• `InvalidOperationException` if consultant does not have Consultant role<br>• `ArgumentException` if priority format is invalid<br>• `NotFoundException` if farm or consultant does not exist |

---

## **Operation Contract – UC002B.2: Validate Consultant Role**

| Item | Description |
|------|-------------|
| **Operation** | Validate that the selected person has the Consultant role before assignment. |
| **Cross References** | UC002B.2 – Assign Nature Check Case to Consultant |
| **Preconditions** | • The person exists in the system. |
| **Postconditions** | • Role validation is completed.<br>• If valid, assignment can proceed. |
| **Input** | • Person ID |
| **Output** | • Boolean indicating if person has Consultant role |
| **Exceptions** | • `NotFoundException` if person does not exist |

---

## **Operation Contract – UC002B.2: Check Farm Has Active Case**

| Item | Description |
|------|-------------|
| **Operation** | Check if a farm already has an active Nature Check Case before creating a new one. |
| **Cross References** | UC002B.2 – Assign Nature Check Case to Consultant |
| **Preconditions** | • The farm exists in the system. |
| **Postconditions** | • Active case status is determined. |
| **Input** | • Farm ID |
| **Output** | • Boolean indicating if farm has active case |
| **Exceptions** | • `NotFoundException` if farm does not exist |

---

## **Operation Contract – UC002B.2: Convert Priority to English**

| Item | Description |
|------|-------------|
| **Operation** | Convert priority from Danish (UI format) to English (database format). |
| **Cross References** | UC002B.2 – Assign Nature Check Case to Consultant |
| **Preconditions** | • Priority value is provided in Danish format. |
| **Postconditions** | • Priority is converted to English format. |
| **Input** | • Priority in Danish ("Lav", "Normal", "Høj", "Haster") |
| **Output** | • Priority in English ("Low", "Medium", "High", "Urgent") |
| **Exceptions** | • `ArgumentException` if priority value is invalid |

---

## **Operation Contract – UC002B.2: Generate Notifications (Not Stored in Database)**

| Item | Description |
|------|-------------|
| **Operation** | Notifications are generated from NatureCheckCase data when consultant views them, not stored in database. |
| **Cross References** | UC002B.2 – Assign Nature Check Case to Consultant<br/>UC002B.6 – View Consultant Notifications |
| **Preconditions** | • A Nature Check Case has been created and assigned to a consultant. |
| **Postconditions** | • Notifications are available as ConsultantNotificationDto objects when consultant views them.<br>• Notifications are generated from NatureCheckCase entities, not stored separately. |
| **Input** | • Consultant ID (when viewing notifications) |
| **Output** | • List of ConsultantNotificationDto objects (generated from NatureCheckCase data) |
| **Exceptions** | • `NotFoundException` if consultant does not exist |
| **Note** | This operation is actually in UC002B.6 (View Consultant Notifications). In UC002B.2, only the case is created. Notifications are generated later when consultant views them.


