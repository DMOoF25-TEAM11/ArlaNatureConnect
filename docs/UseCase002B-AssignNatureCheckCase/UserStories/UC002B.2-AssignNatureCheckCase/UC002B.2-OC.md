# Operation Contracts – UC002B.2: Assign Nature Check Case to Consultant

---

## **Operation Contract – UC002B.2: Assign Nature Check Case**

| Item | Description |
|------|-------------|
| **Operation** | `assignCase(farmId, consultantId, priority, notes)` |
| **Cross References** | UC002B.2 – Assign Nature Check Case to Consultant<br/>UC002B.2-SSD: assignCase operation<br/>UC002B.2-SD: AssignNatureCheckCaseAsync sequence<br/><br/>**Uses:** Validate Consultant Role, Check Farm Has Active Case, Convert Priority to English |
| **Preconditions** | • The selected farm exists in the system.<br>• The selected person exists in the system and has the Consultant role.<br>• The Arla employee assigning the case is authenticated.<br>• No active Nature Check Case is currently assigned to the same farm. |
| **Postconditions** | • A new Nature Check Case is created and linked to the farm and consultant.<br>• Case status is set to "Assigned".<br>• Case creation and assignment timestamps are recorded.<br>• System returns `caseAssigned(caseId)` on success or `error` on failure.<br>• Notifications are available when consultant views them (generated from case data, not stored in database).<br>• Arla employee sees success confirmation message. |
| **Exceptions** | • `InvalidOperationException` if farm already has active case<br>• `InvalidOperationException` if consultant does not have Consultant role<br>• `ArgumentException` if priority format is invalid<br>• `NotFoundException` if farm or consultant does not exist |

---

## **Operation Contract – UC002B.2: Validate Consultant Role**

| Item | Description |
|------|-------------|
| **Operation** | `validateConsultantRole(personId)` |
| **Cross References** | UC002B.2 – Assign Nature Check Case to Consultant<br/>UC002B.2-SD: Role validation sequence |
| **Preconditions** | • The person exists in the system. |
| **Postconditions** | • Role validation is completed.<br>• If valid, assignment can proceed. |
| **Exceptions** | • `NotFoundException` if person does not exist |

---

## **Operation Contract – UC002B.2: Check Farm Has Active Case**

| Item | Description |
|------|-------------|
| **Operation** | `farmHasActiveCase(farmId)` |
| **Cross References** | UC002B.2 – Assign Nature Check Case to Consultant<br/>UC002B.2-SD: FarmHasActiveCaseAsync sequence |
| **Preconditions** | • The farm exists in the system. |
| **Postconditions** | • Active case status is determined.<br>• Returns boolean indicating if farm has active case. |
| **Exceptions** | • `NotFoundException` if farm does not exist |

---

## **Operation Contract – UC002B.2: Convert Priority to English**

| Item | Description |
|------|-------------|
| **Operation** | `convertPriorityToEnglish(priority)` |
| **Cross References** | UC002B.2 – Assign Nature Check Case to Consultant<br/>UC002B.2-SD: ConvertPriorityToEnglish sequence |
| **Preconditions** | • Priority value is provided in Danish format. |
| **Postconditions** | • Priority is converted to English format.<br>• Returns priority in English ("Low", "Medium", "High", "Urgent"). |
| **Exceptions** | • `ArgumentException` if priority value is invalid |

---

## **Operation Contract – UC002B.2: Generate Notifications (Not Stored in Database)**

| Item | Description |
|------|-------------|
| **Operation** | `getNotificationsForConsultant(consultantId)` |
| **Cross References** | UC002B.2 – Assign Nature Check Case to Consultant<br/>UC002B.6 – View Consultant Notifications |
| **Preconditions** | • A Nature Check Case has been created and assigned to a consultant. |
| **Postconditions** | • Notifications are available as ConsultantNotificationDto objects when consultant views them.<br>• Notifications are generated from NatureCheckCase entities, not stored separately.<br>• Returns list of ConsultantNotificationDto objects. |
| **Exceptions** | • `NotFoundException` if consultant does not exist |
| **Note** | This operation is actually in UC002B.6 (View Consultant Notifications). In UC002B.2, only the case is created. Notifications are generated later when consultant views them.


